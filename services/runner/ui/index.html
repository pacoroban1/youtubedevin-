<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Autopilot Studio</title>
    <!-- Cache-bust static assets across reloads -->
    <link rel="stylesheet" href="/ui/styles.css?v=5" />
    <script defer src="/ui/app.js?v=5"></script>
  </head>
  <body>
    <div class="bg">
      <div class="bg__grid"></div>
      <div class="bg__fabric" aria-hidden="true"></div>
      <div class="bg__glow bg__glow--a"></div>
      <div class="bg__glow bg__glow--b"></div>
      <div class="bg__noise" aria-hidden="true"></div>
      <div class="bg__scan" aria-hidden="true"></div>
    </div>

    <header class="topbar">
      <div class="topbar__left">
        <div class="mark" aria-hidden="true">
          <div class="mark__dot"></div>
          <div class="mark__bar"></div>
        </div>
        <div>
          <div class="h1">Autopilot Studio</div>
          <div class="sub">Command your recap pipeline like a control room. <span class="kbd">Cmd</span>/<span class="kbd">Ctrl</span>+<span class="kbd">K</span> for Command Palette.</div>
        </div>
      </div>

      <div class="topbar__right">
        <div class="pill" id="statusPill">
          <span class="pill__led" id="statusLed"></span>
          <span class="pill__text" id="statusText">Idle</span>
        </div>
        <button class="btn btn--ghost" id="btnRefresh" type="button">Refresh</button>
      </div>
    </header>

    <main class="shell">
      <section class="panel">
        <div class="panel__hd">
          <div>
            <div class="panel__title">Run</div>
            <div class="panel__hint">Paste a YouTube ID, or hit Discover.</div>
          </div>
          <div class="panel__actions">
            <button class="btn btn--primary" id="btnFull" type="button">Full Pipeline</button>
            <button class="btn btn--ghost" id="btnCancelJob" type="button" disabled>Cancel Job</button>
          </div>
        </div>

        <div class="field">
          <label class="label" for="videoId">Video ID</label>
          <div class="row">
            <input class="input" id="videoId" placeholder="e.g. dQw4w9WgXcQ" autocomplete="off" />
            <button class="btn btn--soft" id="btnIngest" type="button">Ingest</button>
            <button class="btn btn--soft" id="btnScript" type="button">Script</button>
            <button class="btn btn--soft" id="btnVoice" type="button">Voice</button>
            <button class="btn btn--soft" id="btnRender" type="button">Render</button>
            <button class="btn btn--soft" id="btnThumb" type="button">Thumbnail</button>
            <button class="btn btn--soft" id="btnUpload" type="button">Upload</button>
          </div>
          <div class="help">
            Tip: the full pipeline will run ingest → script → voice → render → thumbnail → upload → distribute.
          </div>
        </div>

        <div class="split">
          <div class="card">
            <div class="card__hd">
              <div class="card__title">Discovery</div>
              <div class="card__meta">YouTube search + ranking</div>
            </div>
            <div class="card__bd">
              <button class="btn btn--primary" id="btnDiscover" type="button">Discover</button>
              <button class="btn btn--ghost" id="btnReport" type="button">Daily Report</button>
            </div>
          </div>

          <div class="card">
            <div class="card__hd">
              <div class="card__title">Engines</div>
              <div class="card__meta">Health + capability checks</div>
            </div>
            <div class="card__bd card__bd--stack">
              <div class="row row--wrap">
                <button class="btn btn--ghost" id="btnVerifyVoice" type="button">Verify Voice</button>
                <button class="btn btn--ghost" id="btnVerifyTranslate" type="button">Verify Translate</button>
                <button class="btn btn--ghost" id="btnVerifyZthumb" type="button">Verify ZThumb</button>
                <button class="btn btn--ghost" id="btnConfig" type="button">Config</button>
              </div>
              <div class="mini" id="engineNotes">
                Engines: <span class="kbd">Gemini</span> only. <span class="kbd">ZThumb</span> disabled.
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panel__hd">
          <div>
            <div class="panel__title">Studio</div>
            <div class="panel__hint">Thumbnails + audio preview, then raw JSON.</div>
          </div>
          <div class="panel__actions">
            <button class="btn btn--ghost" id="btnCopy" type="button">Copy JSON</button>
            <button class="btn btn--ghost" id="btnClear" type="button">Clear</button>
          </div>
        </div>

        <div class="artifacts">
          <div class="artifacts__hd">
            <div>
              <div class="artifacts__title">Artifacts</div>
              <div class="artifacts__meta" id="artifactMeta">Waiting for output…</div>
            </div>
            <div class="artifacts__actions">
              <a class="btn btn--ghost" id="btnOpenMedia" href="/api/media/" target="_blank" rel="noreferrer">Open Media</a>
            </div>
          </div>

          <div class="artifact__grid">
            <div class="artifact artifact--wide">
              <div class="artifact__row">
                <div class="artifact__label">Thumbnails</div>
                <div class="artifact__tools">
                  <button class="btn btn--ghost btn--mini" id="btnSafe" type="button">Safe Area</button>
                  <button class="btn btn--ghost btn--mini" id="btnDownloadThumb" type="button" disabled>Download</button>
                </div>
              </div>
              <div class="thumbhero" id="thumbHero" hidden>
                <img class="thumbhero__img" id="thumbHeroImg" alt="selected thumbnail" />
                <div class="thumbhero__guides" aria-hidden="true"></div>
                <div class="thumbhero__meta" id="thumbHeroMeta"></div>
              </div>
              <div class="thumbs" id="thumbGrid">
                <div class="thumbs__empty">Generate thumbnails to see previews here.</div>
              </div>
            </div>

            <div class="artifactcol">
              <div class="artifact">
                <div class="artifact__label">Voice</div>
                <div class="audio">
                  <canvas class="wave" id="waveCanvas" height="64"></canvas>
                  <audio id="audioEl" controls preload="none"></audio>
                  <a class="link" id="audioLink" href="#" target="_blank" rel="noreferrer" hidden>Open audio</a>
                  <div class="mini" id="audioMeta">Generate voice to preview audio.</div>
                </div>
              </div>

              <div class="artifact">
                <div class="artifact__label">Script</div>
                <div class="scriptbox">
                  <div class="scriptbox__hook" id="scriptHook">Generate script to preview the hook here.</div>
                  <div class="scriptbox__row">
                    <button class="btn btn--ghost btn--mini" id="btnCopyHook" type="button">Copy Hook</button>
                    <div class="mini" id="scriptMeta">Waiting…</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="jobs">
          <div class="jobs__hd">
            <div>
              <div class="jobs__title">Jobs</div>
              <div class="jobs__meta">Recent async runs. Click a job to inspect.</div>
            </div>
            <div class="jobs__actions">
              <button class="btn btn--ghost" id="btnJobsRefresh" type="button">Refresh Jobs</button>
            </div>
          </div>

          <div class="jobs__grid">
            <div class="jobs__list" id="jobsList">
              <div class="jobs__empty">No jobs yet.</div>
            </div>
            <div class="jobs__detail" id="jobDetail">
              <div class="jobdetail__empty" id="jobDetailEmpty">No job selected.</div>

              <div class="jobdetail" id="jobDetailBody" hidden>
                <div class="jobdetail__hd">
                  <div>
                    <div class="jobdetail__title" id="jobTitle">Job</div>
                    <div class="jobdetail__meta" id="jobMeta"></div>
                  </div>
                </div>

                <div class="bar">
                  <div class="bar__fill" id="jobBar"></div>
                </div>
                <div class="bar__meta">
                  <span class="bar__pct" id="jobPct">0%</span>
                  <span class="bar__hint" id="jobHint"></span>
                </div>

                <div class="viz" id="pipelineViz"></div>

                <div class="steps" id="jobSteps"></div>

                <div class="events">
                  <div class="events__hd">
                    <div class="events__title">Events</div>
                    <div class="events__meta">Most recent first</div>
                  </div>
                  <div class="events__bd" id="jobEvents"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <pre class="json" id="jsonOut">{}</pre>

        <div class="logs">
          <div class="logs__hd">
            <div class="logs__title">Activity</div>
            <div class="logs__meta">Local UI log (not container logs)</div>
          </div>
          <div class="logs__bd" id="logOut"></div>
        </div>
      </section>
    </main>

    <footer class="foot">
      <div class="foot__left">
        <span class="muted">Runner:</span>
        <a class="link" href="http://localhost:8000" target="_blank" rel="noreferrer">http://localhost:8000</a>
        <span class="sep">•</span>
        <span class="muted">n8n:</span>
        <a class="link" href="http://localhost:5678" target="_blank" rel="noreferrer">http://localhost:5678</a>
      </div>
      <div class="foot__right">
        <span class="muted">UI served by runner • /ui</span>
      </div>
    </footer>

    <!-- Command palette -->
    <div class="cmdk" id="cmdk" hidden>
      <div class="cmdk__backdrop" id="cmdkBackdrop"></div>
      <div class="cmdk__panel" role="dialog" aria-modal="true" aria-label="Command Palette">
        <div class="cmdk__hd">
          <div class="cmdk__title">Command Palette</div>
          <div class="cmdk__hint">Type to filter. <span class="kbd">Esc</span> to close.</div>
        </div>
        <input class="cmdk__input" id="cmdkInput" placeholder="Search commands…" autocomplete="off" />
        <div class="cmdk__list" id="cmdkList"></div>
      </div>
    </div>
  </body>
</html>
